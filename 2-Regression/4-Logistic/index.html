
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Machine-Learning">
      
      
        <meta name="author" content="Ean Yang">
      
      
        <link rel="canonical" href="https://eanyang7.github.io/Machine-Learning/2-Regression/4-Logistic/">
      
      
        <link rel="prev" href="../3-Linear/solution/Julia/">
      
      
        <link rel="next" href="README.zh-cn/">
      
      
      <link rel="icon" href="../../assets/favicon.jpg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>Logistic regression to predict categories - Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logistic-regression-to-predict-categories" class="md-skip">
          Ë∑≥ËΩ¨Ëá≥
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="È°µÁúâ">
    <a href="../.." title="Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã" class="md-header__button md-logo" aria-label="Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Logistic regression to predict categories
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple"  aria-label="ÂàáÊç¢‰∏∫ÊöóÈªëÊ®°Âºè"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="ÂàáÊç¢‰∏∫ÊöóÈªëÊ®°Âºè" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="red"  aria-label="ÂàáÊç¢‰∏∫ÊµÖËâ≤Ê®°Âºè"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="ÂàáÊç¢‰∏∫ÊµÖËâ≤Ê®°Âºè" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="ÊêúÁ¥¢" placeholder="ÊêúÁ¥¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Êü•Êâæ">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="ÂàÜ‰∫´" aria-label="ÂàÜ‰∫´" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Ê∏ÖÁ©∫ÂΩìÂâçÂÜÖÂÆπ" aria-label="Ê∏ÖÁ©∫ÂΩìÂâçÂÜÖÂÆπ" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Ê≠£Âú®ÂàùÂßãÂåñÊêúÁ¥¢ÂºïÊìé
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/EanYang7/Machine-Learning" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    github‰ªìÂ∫ì
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="ÂØºËà™Ê†è" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã" class="md-nav__button md-logo" aria-label="Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    Êú∫Âô®Â≠¶‰π† Âú®Á∫øÊïôÁ®ã
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EanYang7/Machine-Learning" title="ÂâçÂæÄ‰ªìÂ∫ì" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    github‰ªìÂ∫ì
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Êú∫Âô®Â≠¶‰π†ËØæÁ®ã
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../1-Introduction/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    1 Introduction
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 Regression
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            2 Regression
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regression models for machine learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../README.zh-cn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Êú∫Âô®Â≠¶‰π†‰∏≠ÁöÑÂõûÂΩíÊ®°Âûã
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../1-Tools/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    1 Tools
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../2-Data/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    2 Data
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../3-Linear/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    3 Linear
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 Logistic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            4 Logistic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Logistic regression to predict categories
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Logistic regression to predict categories
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pre-lecture-quiz" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-lecture quiz
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-lecture quiz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#this-lesson-is-available-in-r" class="md-nav__link">
    <span class="md-ellipsis">
      This lesson is available in R!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-the-question" class="md-nav__link">
    <span class="md-ellipsis">
      Define the question
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-logistic-regression" class="md-nav__link">
    <span class="md-ellipsis">
      About logistic regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="About logistic regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#binary-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Binary classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-classifications" class="md-nav__link">
    <span class="md-ellipsis">
      Other classifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-do-not-have-to-correlate" class="md-nav__link">
    <span class="md-ellipsis">
      Variables DO NOT have to correlate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#you-need-a-lot-of-clean-data" class="md-nav__link">
    <span class="md-ellipsis">
      You need a lot of clean data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-tidy-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise - tidy the data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise - tidy the data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization-categorical-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization - categorical plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-pre-processing-feature-and-label-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Data pre-processing: feature and label encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyse-relationships-between-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Analyse relationships between variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-swarm-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Use a swarm plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-your-model" class="md-nav__link">
    <span class="md-ellipsis">
      Build your model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#better-comprehension-via-a-confusion-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Better comprehension via a confusion matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-roc-curve-of-this-model" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the ROC curve of this model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge" class="md-nav__link">
    <span class="md-ellipsis">
      üöÄChallenge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-lecture-quiz" class="md-nav__link">
    <span class="md-ellipsis">
      Post-lecture quiz
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-self-study" class="md-nav__link">
    <span class="md-ellipsis">
      Review &amp; Self Study
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Assignment
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="README.zh-cn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÈÄªËæëÂõûÂΩíÈ¢ÑÊµãÂàÜÁ±ª
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrying some Regression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="assignment.zh-cn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ÂÜçÊé¢ÂõûÂΩíÊ®°Âûã
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="solution/Julia/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Solution
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../3-Web-App/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    3 Web App
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../4-Classification/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    4 Classification
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../5-Clustering/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    5 Clustering
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../6-NLP/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    6 NLP
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../7-TimeSeries/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    7 TimeSeries
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../8-Reinforcement/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    8 Reinforcement
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../9-Real-World/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    9 Real World
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ÁõÆÂΩï">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ÁõÆÂΩï
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pre-lecture-quiz" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-lecture quiz
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-lecture quiz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#this-lesson-is-available-in-r" class="md-nav__link">
    <span class="md-ellipsis">
      This lesson is available in R!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-the-question" class="md-nav__link">
    <span class="md-ellipsis">
      Define the question
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-logistic-regression" class="md-nav__link">
    <span class="md-ellipsis">
      About logistic regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="About logistic regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#binary-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Binary classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-classifications" class="md-nav__link">
    <span class="md-ellipsis">
      Other classifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables-do-not-have-to-correlate" class="md-nav__link">
    <span class="md-ellipsis">
      Variables DO NOT have to correlate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#you-need-a-lot-of-clean-data" class="md-nav__link">
    <span class="md-ellipsis">
      You need a lot of clean data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-tidy-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise - tidy the data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise - tidy the data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization-categorical-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization - categorical plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-pre-processing-feature-and-label-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Data pre-processing: feature and label encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyse-relationships-between-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Analyse relationships between variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-swarm-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Use a swarm plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-your-model" class="md-nav__link">
    <span class="md-ellipsis">
      Build your model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#better-comprehension-via-a-confusion-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Better comprehension via a confusion matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-roc-curve-of-this-model" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the ROC curve of this model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge" class="md-nav__link">
    <span class="md-ellipsis">
      üöÄChallenge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-lecture-quiz" class="md-nav__link">
    <span class="md-ellipsis">
      Post-lecture quiz
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-self-study" class="md-nav__link">
    <span class="md-ellipsis">
      Review &amp; Self Study
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Assignment
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/EanYang7/Machine-Learning/tree/main/docs/2-Regression/4-Logistic/README.md" title="ÁºñËæëÊ≠§È°µ" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/EanYang7/Machine-Learning/tree/main/docs/2-Regression/4-Logistic/README.md" title="Êü•ÁúãÊú¨È°µÁöÑÊ∫ê‰ª£Á†Å" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


<h1 id="logistic-regression-to-predict-categories">Logistic regression to predict categories<a class="headerlink" href="#logistic-regression-to-predict-categories" title="Permanent link">‚öìÔ∏é</a></h1>
<p><img alt="Logistic vs. linear regression infographic" src="images/linear-vs-logistic.png" /></p>
<h2 id="pre-lecture-quiz"><a href="https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/15/">Pre-lecture quiz</a><a class="headerlink" href="#pre-lecture-quiz" title="Permanent link">‚öìÔ∏é</a></h2>
<blockquote>
<h3 id="this-lesson-is-available-in-r"><a href="solution/R/lesson_4.html">This lesson is available in R!</a><a class="headerlink" href="#this-lesson-is-available-in-r" title="Permanent link">‚öìÔ∏é</a></h3>
</blockquote>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">‚öìÔ∏é</a></h2>
<p>In this final lesson on Regression, one of the basic <em>classic</em> ML techniques, we will take a look at Logistic Regression. You would use this technique to discover patterns to predict binary categories. Is this candy chocolate or not? Is this disease contagious or not? Will this customer choose this product or not? </p>
<p>In this lesson, you will learn:</p>
<ul>
<li>A new library for data visualization</li>
<li>Techniques for logistic regression</li>
</ul>
<p>‚úÖ Deepen your understanding of working with this type of regression in this <a href="https://docs.microsoft.com/learn/modules/train-evaluate-classification-models?WT.mc_id=academic-77952-leestott">Learn module</a></p>
<h2 id="prerequisite">Prerequisite<a class="headerlink" href="#prerequisite" title="Permanent link">‚öìÔ∏é</a></h2>
<p>Having worked with the pumpkin data, we are now familiar enough with it to realize that there's one binary category that we can work with: <code>Color</code>.</p>
<p>Let's build a logistic regression model to predict that, given some variables, <em>what color a given pumpkin is likely to be</em> (orange üéÉ or white üëª).</p>
<blockquote>
<p>Why are we talking about binary classification in a lesson grouping about regression? Only for linguistic convenience, as logistic regression is <a href="https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression">really a classification method</a>, albeit a linear-based one. Learn about other ways to classify data in the next lesson group.</p>
</blockquote>
<h2 id="define-the-question">Define the question<a class="headerlink" href="#define-the-question" title="Permanent link">‚öìÔ∏é</a></h2>
<p>For our purposes, we will express this as a binary: 'White' or 'Not White'. There is also a 'striped' category in our dataset but there are few instances of it, so we will not use it. It disappears once we remove null values from the dataset, anyway.</p>
<blockquote>
<p>üéÉ Fun fact, we sometimes call white pumpkins 'ghost' pumpkins. They aren't very easy to carve, so they aren't as popular as the orange ones but they are cool looking! So we could also reformulate our question as: 'Ghost' or 'Not Ghost'. üëª</p>
</blockquote>
<h2 id="about-logistic-regression">About logistic regression<a class="headerlink" href="#about-logistic-regression" title="Permanent link">‚öìÔ∏é</a></h2>
<p>Logistic regression differs from linear regression, which you learned about previously, in a few important ways.</p>
<p><a href="https://youtu.be/KpeCT6nEpBY" title="ML for beginners - Understanding Logistic Regression for Machine Learning Classification"><img alt="ML for beginners - Understanding Logistic Regression for Machine Learning Classification" src="https://img.youtube.com/vi/KpeCT6nEpBY/0.jpg" /></a></p>
<blockquote>
<p>üé• Click the image above for a short video overview of logistic regression.</p>
</blockquote>
<h3 id="binary-classification">Binary classification<a class="headerlink" href="#binary-classification" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Logistic regression does not offer the same features as linear regression. The former offers a prediction about a binary category ("white or not white") whereas the latter is capable of predicting continual values, for example given the origin of a pumpkin and the time of harvest, <em>how much its price will rise</em>.</p>
<p><img alt="Pumpkin classification Model" src="images/pumpkin-classifier.png" /></p>
<blockquote>
<p>Infographic by <a href="https://twitter.com/dasani_decoded">Dasani Madipalli</a></p>
</blockquote>
<h3 id="other-classifications">Other classifications<a class="headerlink" href="#other-classifications" title="Permanent link">‚öìÔ∏é</a></h3>
<p>There are other types of logistic regression, including multinomial and ordinal:</p>
<ul>
<li><strong>Multinomial</strong>, which involves having more than one category - "Orange, White, and Striped".</li>
<li><strong>Ordinal</strong>, which involves ordered categories, useful if we wanted to order our outcomes logically, like our pumpkins that are ordered by a finite number of sizes (mini,sm,med,lg,xl,xxl).</li>
</ul>
<p><img alt="Multinomial vs ordinal regression" src="images/multinomial-vs-ordinal.png" /></p>
<h3 id="variables-do-not-have-to-correlate">Variables DO NOT have to correlate<a class="headerlink" href="#variables-do-not-have-to-correlate" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Remember how linear regression worked better with more correlated variables? Logistic regression is the opposite - the variables don't have to align. That works for this data which has somewhat weak correlations.</p>
<h3 id="you-need-a-lot-of-clean-data">You need a lot of clean data<a class="headerlink" href="#you-need-a-lot-of-clean-data" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Logistic regression will give more accurate results if you use more data; our small dataset is not optimal for this task, so keep that in mind.</p>
<p><a href="https://youtu.be/B2X4H9vcXTs" title="ML for beginners - Data Analysis and Preparation for Logistic Regression"><img alt="ML for beginners - Data Analysis and Preparation for Logistic Regression" src="https://img.youtube.com/vi/B2X4H9vcXTs/0.jpg" /></a></p>
<blockquote>
<p>üé• Click the image above for a short video overview of preparing data for linear regression</p>
</blockquote>
<p>‚úÖ Think about the types of data that would lend themselves well to logistic regression</p>
<h2 id="exercise-tidy-the-data">Exercise - tidy the data<a class="headerlink" href="#exercise-tidy-the-data" title="Permanent link">‚öìÔ∏é</a></h2>
<p>First, clean the data a bit, dropping null values and selecting only some of the columns:</p>
<ol>
<li>
<p>Add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">columns_to_select</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;City Name&#39;</span><span class="p">,</span><span class="s1">&#39;Package&#39;</span><span class="p">,</span><span class="s1">&#39;Variety&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">,</span><span class="s1">&#39;Item Size&#39;</span><span class="p">,</span> <span class="s1">&#39;Color&#39;</span><span class="p">]</span>
<span class="n">pumpkins</span> <span class="o">=</span> <span class="n">full_pumpkins</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columns_to_select</span><span class="p">]</span>

<span class="n">pumpkins</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>You can always take a peek at your new dataframe:</p>
<div class="highlight"><pre><span></span><code><span class="n">pumpkins</span><span class="o">.</span><span class="n">info</span>
</code></pre></div>
</li>
</ol>
<h3 id="visualization-categorical-plot">Visualization - categorical plot<a class="headerlink" href="#visualization-categorical-plot" title="Permanent link">‚öìÔ∏é</a></h3>
<p>By now you have loaded up the <a href="notebook.ipynb">starter notebook</a> with pumpkin data once again and cleaned it so as to preserve a dataset containing a few variables, including <code>Color</code>. Let's visualize the dataframe in the notebook using a different library: <a href="https://seaborn.pydata.org/index.html">Seaborn</a>, which is built on Matplotlib which we used earlier. </p>
<p>Seaborn offers some neat ways to visualize your data. For example, you can compare distributions of the data for each <code>Variety</code> and <code>Color</code> in a categorical plot.</p>
<ol>
<li>
<p>Create such a plot by using the <code>catplot</code> function, using our pumpkin data <code>pumpkins</code>, and specifying a color mapping for each pumpkin category (orange or white):</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">palette</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;ORANGE&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="s1">&#39;WHITE&#39;</span><span class="p">:</span> <span class="s1">&#39;wheat&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span>
<span class="n">data</span><span class="o">=</span><span class="n">pumpkins</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Variety&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Color&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span>
<span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> 
<span class="p">)</span>
</code></pre></div>
<p><img alt="A grid of visualized data" src="images/pumpkins_catplot_1.png" /></p>
<p>By observing the data, you can see how the Color data relates to Variety.</p>
<p>‚úÖ Given this categorical plot, what are some interesting explorations you can envision?</p>
</li>
</ol>
<h3 id="data-pre-processing-feature-and-label-encoding">Data pre-processing: feature and label encoding<a class="headerlink" href="#data-pre-processing-feature-and-label-encoding" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Our pumpkins dataset contains string values for all its columns. Working with categorical data is intuitive for humans but not for machines. Machine learning algorithms work well with numbers. That's why encoding is a very important step in the data pre-processing phase, since it enables us to turn categorical data into numerical data, without losing any information. Good encoding leads to building a good model.</p>
<p>For feature encoding there are two main types of encoders:</p>
<ol>
<li>
<p>Ordinal encoder: it suits well for ordinal variables, which are categorical variables where their data follows a logical ordering, like the <code>Item Size</code> column in our dataset. It creates a mapping such that each category is represented by a number, which is the order of the category in the column.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OrdinalEncoder</span>

<span class="n">item_size_categories</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;sml&#39;</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="s1">&#39;med-lge&#39;</span><span class="p">,</span> <span class="s1">&#39;lge&#39;</span><span class="p">,</span> <span class="s1">&#39;xlge&#39;</span><span class="p">,</span> <span class="s1">&#39;jbo&#39;</span><span class="p">,</span> <span class="s1">&#39;exjbo&#39;</span><span class="p">]]</span>
<span class="n">ordinal_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item Size&#39;</span><span class="p">]</span>
<span class="n">ordinal_encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="n">item_size_categories</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Categorical encoder: it suits well for nominal variables, which are categorical variables where their data does not follow a logical ordering, like all the features different from <code>Item Size</code> in our dataset. It is a one-hot encoding, which means that each category is represented by a binary column: the encoded variable is equal to 1 if the pumpkin belongs to that Variety and 0 otherwise.</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;City Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Package&#39;</span><span class="p">,</span> <span class="s1">&#39;Variety&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">]</span>
<span class="n">categorical_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
Then, <code>ColumnTransformer</code> is used to combine multiple encoders into a single step and apply them to the appropriate columns.</p>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code>    <span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>

    <span class="n">ct</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;ord&#39;</span><span class="p">,</span> <span class="n">ordinal_encoder</span><span class="p">,</span> <span class="n">ordinal_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">categorical_encoder</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="n">ct</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">)</span>
    <span class="n">encoded_features</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pumpkins</span><span class="p">)</span>
</code></pre></div>
On the other hand, to encode the label, we use the scikit-learn <code>LabelEncoder</code> class, which is a utility class to help normalize labels such that they contain only values between 0 and n_classes-1 (here, 0 and 1).</p>
<p><div class="highlight"><pre><span></span><code>    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

    <span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">encoded_label</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">pumpkins</span><span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">])</span>
</code></pre></div>
Once we have encoded the features and the label, we can merge them into a new dataframe <code>encoded_pumpkins</code>.</p>
<p><div class="highlight"><pre><span></span><code>    <span class="n">encoded_pumpkins</span> <span class="o">=</span> <span class="n">encoded_features</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Color</span><span class="o">=</span><span class="n">encoded_label</span><span class="p">)</span>
</code></pre></div>
‚úÖ What are the advantages of using an ordinal encoder for the <code>Item Size</code> column?</p>
<h3 id="analyse-relationships-between-variables">Analyse relationships between variables<a class="headerlink" href="#analyse-relationships-between-variables" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Now that we have pre-processed our data, we can analyse the relationships between the features and the label to grasp an idea of how well the model will be able to predict the label given the features.
The best way to perform this kind of analysis is plotting the data. We'll be using again the Seaborn <code>catplot</code> function, to visualize the relationships between <code>Item Size</code>,  <code>Variety</code> and <code>Color</code> in a categorical plot. To better plot the data we'll be using the encoded <code>Item Size</code> column and the unencoded <code>Variety</code> column.</p>
<p><div class="highlight"><pre><span></span><code>    <span class="n">palette</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ORANGE&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
    <span class="s1">&#39;WHITE&#39;</span><span class="p">:</span> <span class="s1">&#39;wheat&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">pumpkins</span><span class="p">[</span><span class="s1">&#39;Item Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoded_pumpkins</span><span class="p">[</span><span class="s1">&#39;ord__Item Size&#39;</span><span class="p">]</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">pumpkins</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Item Size&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Color&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s1">&#39;Variety&#39;</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin_titles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Item Size&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">row_template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{row_name}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<img alt="A catplot of visualized data" src="images/pumpkins_catplot_2.png" /></p>
<h3 id="use-a-swarm-plot">Use a swarm plot<a class="headerlink" href="#use-a-swarm-plot" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Since Color is a binary category (White or Not), it needs 'a <a href="https://seaborn.pydata.org/tutorial/categorical.html?highlight=bar">specialized approach</a> to visualization'. There are other ways to visualize the relationship of this category with other variables. </p>
<p>You can visualize variables side-by-side with Seaborn plots.</p>
<ol>
<li>
<p>Try a 'swarm' plot to show the distribution of values:</p>
<div class="highlight"><pre><span></span><code><span class="n">palette</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
<span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;wheat&#39;</span>
<span class="p">}</span>
<span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Color&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ord__Item Size&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">encoded_pumpkins</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
</code></pre></div>
<p><img alt="A swarm of visualized data" src="images/swarm_2.png" /></p>
</li>
</ol>
<p><strong>Watch Out</strong>: the code above might generate a warning, since seaborn fails to represent such amount of datapoints into a swam plot. A possible solution is decreasing the size of the marker, by using the 'size' parameter. However, be aware that this affects the readability of the plot.</p>
<blockquote>
<p><strong>üßÆ Show Me The Math</strong></p>
<p>Logistic regression relies on the concept of 'maximum likelihood' using <a href="https://wikipedia.org/wiki/Sigmoid_function">sigmoid functions</a>. A 'Sigmoid Function' on a plot looks like an 'S' shape. It takes a value and maps it to somewhere between 0 and 1. Its curve is also called a 'logistic curve'. Its formula looks like this:</p>
<p><img alt="logistic function" src="images/sigmoid.png" /></p>
<p>where the sigmoid's midpoint finds itself at x's 0 point, L is the curve's maximum value, and k is the curve's steepness. If the outcome of the function is more than 0.5, the label in question will be given the class '1' of the binary choice. If not, it will be classified as '0'.</p>
</blockquote>
<h2 id="build-your-model">Build your model<a class="headerlink" href="#build-your-model" title="Permanent link">‚öìÔ∏é</a></h2>
<p>Building a model to find these binary classification is surprisingly straightforward in Scikit-learn.</p>
<p><a href="https://youtu.be/MmZS2otPrQ8" title="ML for beginners - Logistic Regression for classification of data"><img alt="ML for beginners - Logistic Regression for classification of data" src="https://img.youtube.com/vi/MmZS2otPrQ8/0.jpg" /></a></p>
<blockquote>
<p>üé• Click the image above for a short video overview of building a linear regression model</p>
</blockquote>
<ol>
<li>
<p>Select the variables you want to use in your classification model and split the training and test sets calling <code>train_test_split()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">encoded_pumpkins</span><span class="p">[</span><span class="n">encoded_pumpkins</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="s1">&#39;Color&#39;</span><span class="p">])]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">encoded_pumpkins</span><span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Now you can train your model, by calling <code>fit()</code> with your training data, and print out its result:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">classification_report</span> 
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted labels: &#39;</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1-score: &#39;</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</code></pre></div>
<p>Take a look at your model's scoreboard. It's not bad, considering you have only about 1000 rows of data:</p>
<div class="highlight"><pre><span></span><code><span class="go">                   precision    recall  f1-score   support</span>

<span class="go">                0       0.94      0.98      0.96       166</span>
<span class="go">                1       0.85      0.67      0.75        33</span>

<span class="go">    accuracy                                0.92       199</span>
<span class="go">    macro avg           0.89      0.82      0.85       199</span>
<span class="go">    weighted avg        0.92      0.92      0.92       199</span>

<span class="go">    Predicted labels:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0</span>
<span class="go">    0 0 0 0 0 1 0 1 0 0 1 0 0 0 0 0 1 0 1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="go">    1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 1 0</span>
<span class="go">    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 1 1 0</span>
<span class="go">    0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1</span>
<span class="go">    0 0 0 1 0 0 0 0 0 0 0 0 1 1]</span>
<span class="go">    F1-score:  0.7457627118644068</span>
</code></pre></div>
</li>
</ol>
<h2 id="better-comprehension-via-a-confusion-matrix">Better comprehension via a confusion matrix<a class="headerlink" href="#better-comprehension-via-a-confusion-matrix" title="Permanent link">‚öìÔ∏é</a></h2>
<p>While you can get a scoreboard report <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html?highlight=classification_report#sklearn.metrics.classification_report">terms</a> by printing out the items above, you might be able to understand your model more easily by using a <a href="https://scikit-learn.org/stable/modules/model_evaluation.html#confusion-matrix">confusion matrix</a> to help us understand how the model is performing.</p>
<blockquote>
<p>üéì A '<a href="https://wikipedia.org/wiki/Confusion_matrix">confusion matrix</a>' (or 'error matrix') is a table that expresses your model's true vs. false positives and negatives, thus gauging the accuracy of predictions.</p>
</blockquote>
<ol>
<li>
<p>To use a confusion metrics, call <code>confusion_matrix()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</code></pre></div>
<p>Take a look at your model's confusion matrix:</p>
<div class="highlight"><pre><span></span><code><span class="go">array([[162,   4],</span>
<span class="go">       [ 11,  22]])</span>
</code></pre></div>
</li>
</ol>
<p>In Scikit-learn, confusion matrices Rows (axis 0) are actual labels and columns (axis 1) are predicted labels.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">TN</td>
<td style="text-align: center;">FP</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">FN</td>
<td style="text-align: center;">TP</td>
</tr>
</tbody>
</table>
<p>What's going on here? Let's say our model is asked to classify pumpkins between two binary categories, category 'white' and category 'not-white'.</p>
<ul>
<li>If your model predicts a pumpkin as not white and it belongs to category 'not-white' in reality we call it a true negative, shown by the top left number.</li>
<li>If your model predicts a pumpkin as white and it belongs to category 'not-white' in reality we call it a false negative, shown by the bottom left number. </li>
<li>If your model predicts a pumpkin as not white and it belongs to category 'white' in reality we call it a false positive, shown by the top right number. </li>
<li>If your model predicts a pumpkin as white and it belongs to category 'white' in reality we call it a true positive, shown by the bottom right number.</li>
</ul>
<p>As you might have guessed it's preferable to have a larger number of true positives and true negatives and a lower number of false positives and false negatives, which implies that the model performs better.</p>
<p>How does the confusion matrix relate to precision and recall? Remember, the classification report printed above showed precision (0.85) and recall (0.67).</p>
<p>Precision = tp / (tp + fp) = 22 / (22 + 4) = 0.8461538461538461</p>
<p>Recall = tp / (tp + fn) = 22 / (22 + 11) = 0.6666666666666666</p>
<p>‚úÖ Q: According to the confusion matrix, how did the model do? A: Not bad; there are a good number of true negatives but also a few false negatives. </p>
<p>Let's revisit the terms we saw earlier with the help of the confusion matrix's mapping of TP/TN and FP/FN:</p>
<p>üéì Precision: TP/(TP + FP) The fraction of relevant instances among the retrieved instances (e.g. which labels were well-labeled)</p>
<p>üéì Recall: TP/(TP + FN) The fraction of relevant instances that were retrieved, whether well-labeled or not</p>
<p>üéì f1-score: (2 * precision * recall)/(precision + recall) A weighted average of the precision and recall, with best being 1 and worst being 0</p>
<p>üéì Support: The number of occurrences of each label retrieved</p>
<p>üéì Accuracy: (TP + TN)/(TP + TN + FP + FN) The percentage of labels predicted accurately for a sample.</p>
<p>üéì Macro Avg: The calculation of the unweighted mean metrics for each label, not taking label imbalance into account.</p>
<p>üéì Weighted Avg: The calculation of the mean metrics for each label, taking label imbalance into account by weighting them by their support (the number of true instances for each label).</p>
<p>‚úÖ Can you think which metric you should watch if you want your model to reduce the number of false negatives?</p>
<h2 id="visualize-the-roc-curve-of-this-model">Visualize the ROC curve of this model<a class="headerlink" href="#visualize-the-roc-curve-of-this-model" title="Permanent link">‚öìÔ∏é</a></h2>
<p><a href="https://youtu.be/GApO575jTA0" title="ML for beginners - Analyzing Logistic Regression Performance with ROC Curves"><img alt="ML for beginners - Analyzing Logistic Regression Performance with ROC Curves" src="https://img.youtube.com/vi/GApO575jTA0/0.jpg" /></a></p>
<blockquote>
<p>üé• Click the image above for a short video overview of ROC curves</p>
</blockquote>
<p>Let's do one more visualization to see the so-called 'ROC' curve:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">y_scores</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>Using Matplotlib, plot the model's <a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_roc.html?highlight=roc">Receiving Operating Characteristic</a> or ROC. ROC curves are often used to get a view of the output of a classifier in terms of its true vs. false positives. "ROC curves typically feature true positive rate on the Y axis, and false positive rate on the X axis." Thus, the steepness of the curve and the space between the midpoint line and the curve matter: you want a curve that quickly heads up and over the line. In our case, there are false positives to start with, and then the line heads up and over properly:</p>
<p><img alt="ROC" src="images/ROC_2.png" /></p>
<p>Finally, use Scikit-learn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html?highlight=roc_auc#sklearn.metrics.roc_auc_score"><code>roc_auc_score</code> API</a> to compute the actual 'Area Under the Curve' (AUC):</p>
<p><div class="highlight"><pre><span></span><code><span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_scores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
</code></pre></div>
The result is <code>0.9749908725812341</code>. Given that the AUC ranges from 0 to 1, you want a big score, since a model that is 100% correct in its predictions will have an AUC of 1; in this case, the model is <em>pretty good</em>. </p>
<p>In future lessons on classifications, you will learn how to iterate to improve your model's scores. But for now, congratulations! You've completed these regression lessons!</p>
<hr />
<h2 id="challenge">üöÄChallenge<a class="headerlink" href="#challenge" title="Permanent link">‚öìÔ∏é</a></h2>
<p>There's a lot more to unpack regarding logistic regression! But the best way to learn is to experiment. Find a dataset that lends itself to this type of analysis and build a model with it. What do you learn? tip: try <a href="https://www.kaggle.com/search?q=logistic+regression+datasets">Kaggle</a> for interesting datasets.</p>
<h2 id="post-lecture-quiz"><a href="https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/16/">Post-lecture quiz</a><a class="headerlink" href="#post-lecture-quiz" title="Permanent link">‚öìÔ∏é</a></h2>
<h2 id="review-self-study">Review &amp; Self Study<a class="headerlink" href="#review-self-study" title="Permanent link">‚öìÔ∏é</a></h2>
<p>Read the first few pages of <a href="https://web.stanford.edu/~jurafsky/slp3/5.pdf">this paper from Stanford</a> on some practical uses for logistic regression. Think about tasks that are better suited for one or the other type of regression tasks that we have studied up to this point. What would work best?</p>
<h2 id="assignment">Assignment<a class="headerlink" href="#assignment" title="Permanent link">‚öìÔ∏é</a></h2>
<p><a href="assignment/">Retrying this regression</a></p>

  <hr>
<div class="md-source-file">
  <small>
    
      ÊúÄÂêéÊõ¥Êñ∞:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 22, 2023</span>
      
        <br>
        ÂàõÂª∫Êó•Êúü:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 22, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  ÂõûÂà∞È°µÈù¢È°∂ÈÉ®
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="È°µËÑö" >
        
          
          <a href="../3-Linear/solution/Julia/" class="md-footer__link md-footer__link--prev" aria-label="‰∏ä‰∏ÄÈ°µ: Index">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ‰∏ä‰∏ÄÈ°µ
              </span>
              <div class="md-ellipsis">
                Index
              </div>
            </div>
          </a>
        
        
          
          <a href="README.zh-cn/" class="md-footer__link md-footer__link--next" aria-label="‰∏ã‰∏ÄÈ°µ: ÈÄªËæëÂõûÂΩíÈ¢ÑÊµãÂàÜÁ±ª">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ‰∏ã‰∏ÄÈ°µ
              </span>
              <div class="md-ellipsis">
                ÈÄªËæëÂõûÂΩíÈ¢ÑÊµãÂàÜÁ±ª
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Ean Yang
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/YQisme" target="_blank" rel="noopener" title="github‰∏ªÈ°µ" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://space.bilibili.com/244185393?spm_id_from=333.788.0.0" target="_blank" rel="noopener" title="bÁ´ô‰∏ªÈ°µ" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0s16.1 2.868 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0c8.8 0 16.1 2.868 21.9 8.603 5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1zm-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8 6.3-6.5 9.7-14.3 10.1-23.5V173.8zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5-9.6 0-17.5-3.2-23.6-9.5-6.1-6.3-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2 6.3-6.3 13.2-9.6 23.3-10 9.2.4 17 3.7 23.3 10zm191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.1 6.3-14 9.5-23.6 9.5-9.6 0-17.4-3.2-23.6-9.5-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2 6.3-6.3 14.1-9.6 23.3-10 9.2.4 17 3.7 23.3 10z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://eanyang7.com" target="_blank" rel="noopener" title="‰∏™‰∫∫‰∏ªÈ°µ" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M112 48a48 48 0 1 1 96 0 48 48 0 1 1-96 0zm40 304v128c0 17.7-14.3 32-32 32s-32-14.3-32-32V256.9l-28.6 47.6c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6h29.7c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V352h-16z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.prune", "navigation.top", "toc.follow", "header.autohide", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>